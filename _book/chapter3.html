
<!DOCTYPE HTML>
<html lang="zh-hans" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>3 目标检测模型 · Machine Vision CookBook with TensorFlow2</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="AnFany">
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-anchors/plugin.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-tbfed-pagefooter/footer.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-donate/plugin.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-chapter-fold/chapter-fold.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-back-to-top-button/plugin.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-code/plugin.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-auto-scroll-table/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-pageview-count/plugin.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="chapter3.html" />
    
    
    <link rel="prev" href="chapter2.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="输入并搜索" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./#tensorflow2-object-detection-api-全流程文档">
            
                    
                    序
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1.1" data-path="./">
            
                <a href="./#序：无关编码">
            
                    
                    序：无关编码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.2" data-path="./">
            
                <a href="./#扫码关注">
            
                    
                    扫码关注
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.3" data-path="./">
            
                <a href="./#联系作者">
            
                    
                    联系作者
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="chapter1.html">
            
                <a href="chapter1.html#1-win10系统tensorflow-gpu22安装">
            
                    
                    1 Win10系统安装TensorFlow-gpu2.2
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="chapter1.html">
            
                <a href="chapter1.html#11-显卡驱动">
            
                    
                    1.1  显卡驱动
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.1" data-path="chapter1.html">
            
                <a href="chapter1.html#111-选择版本">
            
                    
                    1.1.1 选择版本
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.2" data-path="chapter1.html">
            
                <a href="chapter1.html#112-安装">
            
                    
                    1.1.2 安装
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="chapter1.html">
            
                <a href="chapter1.html#12-cuda工具包">
            
                    
                    1.2 CUDA工具包
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.2.1" data-path="chapter1.html">
            
                <a href="chapter1.html#121-选择版本">
            
                    
                    1.2.1 选择版本
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.2" data-path="chapter1.html">
            
                <a href="chapter1.html#122-自定义安装">
            
                    
                    1.2.2 自定义安装
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.3" data-path="chapter1.html">
            
                <a href="chapter1.html#123-添加环境变量">
            
                    
                    1.2.3 添加环境变量
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.4" data-path="chapter1.html">
            
                <a href="chapter1.html#124-验证安装">
            
                    
                    1.2.4 验证安装
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="chapter1.html">
            
                <a href="chapter1.html#13-cudnn">
            
                    
                    1.3 cuDNN
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.3.1" data-path="chapter1.html">
            
                <a href="chapter1.html#131-选择版本">
            
                    
                    1.3.1 选择版本
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3.2" data-path="chapter1.html">
            
                <a href="chapter1.html#132-移动文件">
            
                    
                    1.3.2 移动文件
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="chapter1.html">
            
                <a href="chapter1.html#14-安装anaconda">
            
                    
                    1.4 安装Anaconda
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.4.1" data-path="chapter1.html">
            
                <a href="chapter1.html#141-下载">
            
                    
                    1.4.1 下载
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.2" data-path="chapter1.html">
            
                <a href="chapter1.html#142-验证安装">
            
                    
                    1.4.2 验证安装
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.3" data-path="chapter1.html">
            
                <a href="chapter1.html#143-conda创建虚拟环境">
            
                    
                    1.4.3 conda创建虚拟环境
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.4" data-path="chapter1.html">
            
                <a href="chapter1.html#144-激活虚拟环境">
            
                    
                    1.4.4 激活虚拟环境
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="chapter1.html">
            
                <a href="chapter1.html#15-运行方式">
            
                    
                    1.5 运行方式
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.5.1" data-path="chapter1.html">
            
                <a href="chapter1.html#151-jupyter-notebook">
            
                    
                    1.5.1 Jupyter Notebook
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.5.1.1" >
            
                <span>
            
                    
                    1.5.1.1 建立python3.8虚拟环境
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5.1.2" >
            
                <span>
            
                    
                    1.5.1.2 安装tensorflow-gpu 2.2 版本
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5.1.3" >
            
                <span>
            
                    
                    1.5.1.3 安装ipython
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5.1.4" >
            
                <span>
            
                    
                    1.5.1.4 安装jupyter notebook
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5.1.5" >
            
                <span>
            
                    
                    1.5.1.5 安装ipykernel
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5.1.6" >
            
                <span>
            
                    
                    1.5.1.6 更改文件路径
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5.1.7" >
            
                <span>
            
                    
                    1.5.1.7 验证安装
            
                </span>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.5.2" data-path="chapter1.html">
            
                <a href="chapter1.html#152-pycharm">
            
                    
                    1.5.2 PyCharm
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.5.2.1" >
            
                <span>
            
                    
                    1.5.2.1 下载社区版本
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5.2.2" >
            
                <span>
            
                    
                    1.5.2.2 设置编译器
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5.2.3" >
            
                <span>
            
                    
                    1.5.2.3 验证
            
                </span>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.5.3" data-path="chapter1.html">
            
                <a href="chapter1.html#153-错误问题汇集">
            
                    
                    1.5.3 错误问题汇集
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.5.3.1" >
            
                <span>
            
                    
                    1.5.3.1 出现出现.pywrap_tensorflow_internal import错误
            
                </span>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="chapter2.html">
            
                <a href="chapter2.html#2-搭建object-detection环境">
            
                    
                    2 搭建Object Detection环境
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="chapter2.html">
            
                <a href="chapter2.html#21-安装tensorflow模型库">
            
                    
                    2.1 安装TenorFlow模型库
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="chapter2.html">
            
                <a href="chapter2.html#22-protobuf安装与编译">
            
                    
                    2.2 Protobuf安装与编译
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1" data-path="chapter2.html">
            
                <a href="chapter2.html#221-下载protoc">
            
                    
                    2.2.1 下载protoc
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2" data-path="chapter2.html">
            
                <a href="chapter2.html#222-验证">
            
                    
                    2.2.2 验证
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.3" data-path="chapter2.html">
            
                <a href="chapter2.html#223-编译">
            
                    
                    2.2.3 编译
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="chapter2.html">
            
                <a href="chapter2.html#23-安装coco-api">
            
                    
                    2.3 安装COCO API
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.3.1" data-path="chapter2.html">
            
                <a href="chapter2.html#231-安装cython">
            
                    
                    2.3.1 安装cython
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.2" data-path="chapter2.html">
            
                <a href="chapter2.html#232-下载coco-api压缩包">
            
                    
                    2.3.2 下载coco-api压缩包
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.3" data-path="chapter2.html">
            
                <a href="chapter2.html#233-安装">
            
                    
                    2.3.3 安装
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="chapter2.html">
            
                <a href="chapter2.html#24-安装object-detection-api">
            
                    
                    2.4 安装Object Detection API
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="chapter3.html">
            
                <a href="chapter3.html#3-目标检测模型">
            
                    
                    3 目标检测模型
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="chapter3.html">
            
                <a href="chapter3.html#31-模型下载">
            
                    
                    3.1 模型下载
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1" data-path="chapter3.html">
            
                <a href="chapter3.html#311-获取模型信息">
            
                    
                    3.1.1 获取模型信息
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.2" data-path="chapter3.html">
            
                <a href="chapter3.html#312-下载模型">
            
                    
                    3.1.2 下载模型
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="chapter3.html">
            
                <a href="chapter3.html#32-图片目标检测">
            
                    
                    3.2 图片目标检测
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="chapter3.html">
            
                <a href="chapter3.html#33-视频目标检测">
            
                    
                    3.3 视频目标检测
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.3.1" data-path="chapter3.html">
            
                <a href="chapter3.html#331-本地视频">
            
                    
                    3.3.1 本地视频
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.2" data-path="chapter3.html">
            
                <a href="chapter3.html#332-在线视频">
            
                    
                    3.3.2 在线视频
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="chapter4.html">
            
                <a href="chapter4.html#4-训练目标检测模型">
            
                    
                    4 训练目标检测模型
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="chapter4.html">
            
                <a href="chapter4.html#41-文件结构搭建">
            
                    
                    4.1 文件结构搭建
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="chapter4.html">
            
                <a href="chapter4.html#42-准备数据集">
            
                    
                    4.2 准备数据集
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.2.1" data-path="chapter4.html">
            
                <a href="chapter4.html#421-数据标注">
            
                    
                    4.2.1 数据标注
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.2" data-path="chapter4.html">
            
                <a href="chapter4.html#422-数据集分割">
            
                    
                    4.2.2 数据集分割
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.3" data-path="chapter4.html">
            
                <a href="chapter4.html#423-创建标签映射">
            
                    
                    4.2.3 创建标签映射
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.4" data-path="chapter4.html">
            
                <a href="chapter4.html#424-转xml为record格式">
            
                    
                    4.2.4 转*.xml为*.record
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="chapter4.html">
            
                <a href="chapter4.html#43-构建训练任务">
            
                    
                    4.3 构建训练任务
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.3.1" data-path="chapter4.html">
            
                <a href="chapter4.html#431-获取预训练模型">
            
                    
                    4.3.1 获取预训练模型
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.2" data-path="chapter4.html">
            
                <a href="chapter4.html#432-配置训练管道">
            
                    
                    4.3.2 配置训练管道
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.3.2.1" >
            
                <span>
            
                    
                    4.3.2.1 设置检测对象类的格式
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.2.2" >
            
                <span>
            
                    
                    4.3.2.2 修改批训练大小
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.2.3" >
            
                <span>
            
                    
                    4.3.2.3 模型配置
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.2.4" >
            
                <span>
            
                    
                    4.3.2.4 训练数据集
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.2.5" >
            
                <span>
            
                    
                    4.3.2.5 测试数据集
            
                </span>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.3.3" data-path="chapter4.html">
            
                <a href="chapter4.html#433-训练模型">
            
                    
                    4.3.3 训练模型
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.3.3.1" >
            
                <span>
            
                    
                    4.3.3.1 No module named 'lvis'
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.3.2" >
            
                <span>
            
                    
                    4.3.3.2 No module named 'official'
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.3.3" >
            
                <span>
            
                    
                    4.3.3.3 No module named 'yaml'
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.3.4" >
            
                <span>
            
                    
                    4.3.3.4 开始训练
            
                </span>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.3.4" data-path="chapter4.html">
            
                <a href="chapter4.html#434-训练过程可视化">
            
                    
                    4.3.4 训练过程可视化
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="chapter4.html">
            
                <a href="chapter4.html#44-评估模型">
            
                    
                    4.4 评估模型
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.4.1" data-path="chapter4.html">
            
                <a href="chapter4.html#441-设置评估标准">
            
                    
                    4.4.1 设置评估标准
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.2" data-path="chapter4.html">
            
                <a href="chapter4.html#442-评估">
            
                    
                    4.4.2 评估
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.3" data-path="chapter4.html">
            
                <a href="chapter4.html#443-评估结果查看">
            
                    
                    4.4.3 评估结果查看
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="chapter4.html">
            
                <a href="chapter4.html#45-模型保存">
            
                    
                    4.5 模型保存
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6" data-path="chapter4.html">
            
                <a href="chapter4.html#46-模型预测">
            
                    
                    4.6 模型预测
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="chapter5.html">
            
                <a href="chapter5.html#5-人脸识别模型">
            
                    
                    5 人脸识别模型
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="chapter5.html">
            
                <a href="chapter5.html#51-mtcnn">
            
                    
                    5.1 MTCNN
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1.1" data-path="chapter5.html">
            
                <a href="chapter5.html#511-人脸检测">
            
                    
                    5.1.1 人脸检测
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.1.2" data-path="chapter5.html">
            
                <a href="chapter5.html#512-人脸对齐">
            
                    
                    5.1.2 人脸对齐
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="chapter5.html">
            
                <a href="chapter5.html#52-facenet">
            
                    
                    5.2 FaceNet
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.2.1" data-path="chapter5.html">
            
                <a href="chapter5.html#521-下载facenet源码">
            
                    
                    5.2.1 下载FaceNet源码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.2" data-path="chapter5.html">
            
                <a href="chapter5.html#522-下载预训练模型">
            
                    
                    5.2.2 下载预训练模型
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.3" data-path="chapter5.html">
            
                <a href="chapter5.html#523-人脸数据库">
            
                    
                    5.2.3 人脸数据库
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.2.3.1" >
            
                <span>
            
                    
                    5.2.3.1 建立人脸数据库
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.3.2" >
            
                <span>
            
                    
                    5.2.3.2 数据库人脸编码
            
                </span>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.2.4" data-path="chapter5.html">
            
                <a href="chapter5.html#524-人脸编码距离">
            
                    
                    5.2.4 人脸编码距离
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.5" data-path="chapter5.html">
            
                <a href="chapter5.html#525-图片人脸识别">
            
                    
                    5.2.5 图片人脸识别
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.6" data-path="chapter5.html">
            
                <a href="chapter5.html#526-视频人脸识别">
            
                    
                    5.2.6 视频人脸识别
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="chapter6.md">
            
                <span>
            
                    
                    6 目标检测知识备忘
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="chapter7.md">
            
                <span>
            
                    
                    7 附录
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            本书使用 GitBook 发布
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >3 目标检测模型</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="3-&#x76EE;&#x6807;&#x68C0;&#x6D4B;&#x6A21;&#x578B;"><a name="3-&#x76EE;&#x6807;&#x68C0;&#x6D4B;&#x6A21;&#x578B;" class="plugin-anchor" href="#3-&#x76EE;&#x6807;&#x68C0;&#x6D4B;&#x6A21;&#x578B;"><i class="fa fa-link" aria-hidden="true"></i></a>3 &#x76EE;&#x6807;&#x68C0;&#x6D4B;&#x6A21;&#x578B;</h1>
<h2 id="31-&#x6A21;&#x578B;&#x4E0B;&#x8F7D;"><a name="31-&#x6A21;&#x578B;&#x4E0B;&#x8F7D;" class="plugin-anchor" href="#31-&#x6A21;&#x578B;&#x4E0B;&#x8F7D;"><i class="fa fa-link" aria-hidden="true"></i></a>3.1 &#x6A21;&#x578B;&#x4E0B;&#x8F7D;</h2>
<p>&#x6A21;&#x578B;&#x5E93;&#x5B98;&#x7F51;&#xFF1A;<a href="https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/tf2_detection_zoo.md" target="_blank">https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/tf2_detection_zoo.md</a></p>
<p>&#x5229;&#x7528;python&#x7A0B;&#x5E8F;&#x5C06;&#x6240;&#x6709;&#x7684;&#x6A21;&#x578B;&#x4E0B;&#x8F7D;&#x5230;&#x672C;&#x5730;&#xFF0C;&#x5E76;&#x8BFB;&#x53D6;&#x5404;&#x79CD;&#x6A21;&#x578B;&#x7684;&#x7CBE;&#x786E;&#x5EA6;&#x3002;</p>
<h3 id="311-&#x83B7;&#x53D6;&#x6A21;&#x578B;&#x4FE1;&#x606F;"><a name="311-&#x83B7;&#x53D6;&#x6A21;&#x578B;&#x4FE1;&#x606F;" class="plugin-anchor" href="#311-&#x83B7;&#x53D6;&#x6A21;&#x578B;&#x4FE1;&#x606F;"><i class="fa fa-link" aria-hidden="true"></i></a>3.1.1 &#x83B7;&#x53D6;&#x6A21;&#x578B;&#x4FE1;&#x606F;</h3>
<p>&#x83B7;&#x53D6;&#x6A21;&#x578B;&#x4FE1;&#x606F;python&#x7A0B;&#x5E8F;</p>
<pre><code class="lang-python"><span class="hljs-comment">#!/usr/bin/env python</span>
<span class="hljs-comment"># author:AnFany</span>
<span class="hljs-comment"># datetime:2020/12/4 9:41</span>


<span class="hljs-keyword">import</span> requests       <span class="hljs-comment">#&#x5BFC;&#x5165;requests&#x5305;</span>
<span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup
<span class="hljs-keyword">import</span> re
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd

<span class="hljs-comment"># &#x4ECE;github&#x83B7;&#x53D6;&#x94FE;&#x63A5;&#xFF0C;&#x5C06;&#x6240;&#x6709;&#x6A21;&#x578B;&#x4E0B;&#x8F7D;&#x5230;&#x672C;&#x5730;</span>
Github_Address = <span class="hljs-string">r&apos;https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/tf2_detection_zoo.md&apos;</span>
Headers = {<span class="hljs-string">&quot;User-Agent&quot;</span>:<span class="hljs-string">&quot;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) &quot;</span>
                                  <span class="hljs-string">&quot;Chrome/73.0.3683.86 Safari/537.36&quot;</span>}
strhtml = requests.get(Github_Address, headers=Headers)
<span class="hljs-comment"># &#x83B7;&#x53D6;&#x8868;&#x683C;</span>
soup_table = BeautifulSoup(strhtml.text,<span class="hljs-string">&apos;lxml&apos;</span>).table

<span class="hljs-comment"># tr&#x6807;&#x7B7E;&#x5185;&#x7684;&#x6570;&#x636E;</span>
tr_set = soup_table.find_all(<span class="hljs-string">&quot;tr&quot;</span>)

<span class="hljs-comment"># &#x5B57;&#x5178;&#x5F62;&#x5F0F;&#x5B58;&#x50A8;&#x6570;&#x636E;</span>
Model_Dict = {}

Start_Sign = <span class="hljs-number">0</span>

<span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> tr_set:
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> Start_Sign:
        Start_Sign += <span class="hljs-number">1</span>
    <span class="hljs-keyword">else</span>:
        uu = [ss <span class="hljs-keyword">for</span> ss <span class="hljs-keyword">in</span> k.get_text().split(<span class="hljs-string">&apos;\n&apos;</span>) <span class="hljs-keyword">if</span> ss]
        <span class="hljs-comment"># &#x4E0B;&#x8F7D;&#x94FE;&#x63A5;</span>
        <span class="hljs-keyword">for</span> gu <span class="hljs-keyword">in</span> k.find_all(<span class="hljs-string">&apos;a&apos;</span>):
            link = gu[<span class="hljs-string">&apos;href&apos;</span>]
        <span class="hljs-comment"># &#x56FE;&#x7247;&#x6216;&#x8005;&#x89C6;&#x9891;</span>
        <span class="hljs-keyword">if</span> <span class="hljs-string">&apos;/&apos;</span> <span class="hljs-keyword">in</span> uu[<span class="hljs-number">2</span>]:
            fig_s, video_s = uu[<span class="hljs-number">2</span>].split(<span class="hljs-string">&apos;/&apos;</span>)
            Model_Dict[uu[<span class="hljs-number">0</span>]] = {<span class="hljs-string">&apos;&#x901F;&#x5EA6;&apos;</span>: uu[<span class="hljs-number">1</span>], <span class="hljs-string">&apos;&#x56FE;&#x7247;&apos;</span>: fig_s, <span class="hljs-string">&apos;&#x89C6;&#x9891;&apos;</span>: video_s}
        <span class="hljs-keyword">else</span>:
            Model_Dict[uu[<span class="hljs-number">0</span>]] = {<span class="hljs-string">&apos;&#x901F;&#x5EA6;&apos;</span>: uu[<span class="hljs-number">1</span>], <span class="hljs-string">&apos;&#x56FE;&#x7247;&apos;</span>: uu[<span class="hljs-number">2</span>], <span class="hljs-string">&apos;&#x89C6;&#x9891;&apos;</span>: <span class="hljs-number">0</span>}
        <span class="hljs-comment"># &#x5B9E;&#x73B0;&#x7684;&#x529F;&#x80FD;</span>
        <span class="hljs-keyword">for</span> g <span class="hljs-keyword">in</span> [<span class="hljs-string">&apos;Boxes&apos;</span>, <span class="hljs-string">&apos;Keypoints&apos;</span>, <span class="hljs-string">&apos;Masks&apos;</span>]:
            <span class="hljs-keyword">if</span> g <span class="hljs-keyword">in</span> uu[<span class="hljs-number">3</span>]:
                Model_Dict[uu[<span class="hljs-number">0</span>]][g] = <span class="hljs-number">1</span>
            <span class="hljs-keyword">else</span>:
                Model_Dict[uu[<span class="hljs-number">0</span>]][g] = <span class="hljs-number">0</span>
        Model_Dict[uu[<span class="hljs-number">0</span>]][<span class="hljs-string">&apos;&#x5730;&#x5740;&apos;</span>] = link

<span class="hljs-comment"># &#x5C06;&#x5B57;&#x5178;&#x5F62;&#x5F0F;&#x8F6C;&#x6362;</span>
Dict_Model = {}
<span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> Model_Dict:
    <span class="hljs-keyword">if</span> <span class="hljs-string">&apos;&#x6A21;&#x578B;&apos;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> Dict_Model:
        Dict_Model[<span class="hljs-string">&apos;&#x6A21;&#x578B;&apos;</span>] = [l]
    <span class="hljs-keyword">else</span>:
        Dict_Model[<span class="hljs-string">&apos;&#x6A21;&#x578B;&apos;</span>].append(l)
    <span class="hljs-keyword">for</span> kn <span class="hljs-keyword">in</span>  Model_Dict[l]:
        <span class="hljs-keyword">if</span> kn <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> Dict_Model:
            Dict_Model[kn] = [Model_Dict[l][kn]]
        <span class="hljs-keyword">else</span>:
            Dict_Model[kn].append(Model_Dict[l][kn])

<span class="hljs-comment"># &#x5199;&#x5165;&#x6587;&#x4EF6;</span>
Model_Data = pd.DataFrame(Dict_Model)
Model_Data.to_csv(<span class="hljs-string">&apos;tfod_model_zoo.csv&apos;</span>, index=<span class="hljs-keyword">False</span>, encoding=<span class="hljs-string">&apos;gbk&apos;</span>)
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:center">&#x6A21;&#x578B;</th>
<th style="text-align:right">&#x901F;&#x5EA6;(ms)</th>
<th>&#x56FE;&#x7247;(coco MAP)</th>
<th>&#x89C6;&#x9891;(coco MAP)</th>
<th>Boxes</th>
<th>Key Points</th>
<th>Masks</th>
<th style="text-align:left">&#x4E0B;&#x8F7D;</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">CenterNet HourGlass104 512x512</td>
<td style="text-align:right">70</td>
<td>41.9</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200713/centernet_hg104_512x512_coco17_tpu-8.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">CenterNet HourGlass104 Keypoints 512x512</td>
<td style="text-align:right">76</td>
<td>40</td>
<td>61.4</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/centernet_hg104_512x512_kpts_coco17_tpu-32.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">CenterNet HourGlass104 1024x1024</td>
<td style="text-align:right">197</td>
<td>44.5</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200713/centernet_hg104_1024x1024_coco17_tpu-32.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">CenterNet HourGlass104 Keypoints 1024x1024</td>
<td style="text-align:right">211</td>
<td>42.8</td>
<td>64.5</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/centernet_hg104_1024x1024_kpts_coco17_tpu-32.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">CenterNet Resnet50 V1 FPN 512x512</td>
<td style="text-align:right">27</td>
<td>31.2</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/centernet_resnet50_v1_fpn_512x512_coco17_tpu-8.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">CenterNet Resnet50 V1 FPN Keypoints 512x512</td>
<td style="text-align:right">30</td>
<td>29.3</td>
<td>50.7</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/centernet_resnet50_v1_fpn_512x512_kpts_coco17_tpu-8.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">CenterNet Resnet101 V1 FPN 512x512</td>
<td style="text-align:right">34</td>
<td>34.2</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/centernet_resnet101_v1_fpn_512x512_coco17_tpu-8.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">CenterNet Resnet50 V2 512x512</td>
<td style="text-align:right">27</td>
<td>29.5</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/centernet_resnet50_v2_512x512_coco17_tpu-8.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">CenterNet Resnet50 V2 Keypoints 512x512</td>
<td style="text-align:right">30</td>
<td>27.6</td>
<td>48.2</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/centernet_resnet50_v2_512x512_kpts_coco17_tpu-8.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">EfficientDet D0 512x512</td>
<td style="text-align:right">39</td>
<td>33.6</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/efficientdet_d0_coco17_tpu-32.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">EfficientDet D1 640x640</td>
<td style="text-align:right">54</td>
<td>38.4</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/efficientdet_d1_coco17_tpu-32.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">EfficientDet D2 768x768</td>
<td style="text-align:right">67</td>
<td>41.8</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/efficientdet_d2_coco17_tpu-32.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">EfficientDet D3 896x896</td>
<td style="text-align:right">95</td>
<td>45.4</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/efficientdet_d3_coco17_tpu-32.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">EfficientDet D4 1024x1024</td>
<td style="text-align:right">133</td>
<td>48.5</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/efficientdet_d4_coco17_tpu-32.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">EfficientDet D5 1280x1280</td>
<td style="text-align:right">222</td>
<td>49.7</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/efficientdet_d5_coco17_tpu-32.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">EfficientDet D6 1280x1280</td>
<td style="text-align:right">268</td>
<td>50.5</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/efficientdet_d6_coco17_tpu-32.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">EfficientDet D7 1536x1536</td>
<td style="text-align:right">325</td>
<td>51.2</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/efficientdet_d7_coco17_tpu-32.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">SSD MobileNet v2 320x320</td>
<td style="text-align:right">19</td>
<td>20.2</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/ssd_mobilenet_v2_320x320_coco17_tpu-8.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">SSD MobileNet V1 FPN 640x640</td>
<td style="text-align:right">48</td>
<td>29.1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/ssd_mobilenet_v1_fpn_640x640_coco17_tpu-8.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">SSD MobileNet V2 FPNLite 320x320</td>
<td style="text-align:right">22</td>
<td>22.2</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/ssd_mobilenet_v2_fpnlite_320x320_coco17_tpu-8.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">SSD MobileNet V2 FPNLite 640x640</td>
<td style="text-align:right">39</td>
<td>28.2</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/ssd_mobilenet_v2_fpnlite_640x640_coco17_tpu-8.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">SSD ResNet50 V1 FPN 640x640 (RetinaNet50)</td>
<td style="text-align:right">46</td>
<td>34.3</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/ssd_resnet50_v1_fpn_640x640_coco17_tpu-8.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">SSD ResNet50 V1 FPN 1024x1024 (RetinaNet50)</td>
<td style="text-align:right">87</td>
<td>38.3</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/ssd_resnet50_v1_fpn_1024x1024_coco17_tpu-8.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">SSD ResNet101 V1 FPN 640x640 (RetinaNet101)</td>
<td style="text-align:right">57</td>
<td>35.6</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/ssd_resnet101_v1_fpn_640x640_coco17_tpu-8.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">SSD ResNet101 V1 FPN 1024x1024 (RetinaNet101)</td>
<td style="text-align:right">104</td>
<td>39.5</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/ssd_resnet101_v1_fpn_1024x1024_coco17_tpu-8.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">SSD ResNet152 V1 FPN 640x640 (RetinaNet152)</td>
<td style="text-align:right">80</td>
<td>35.4</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/ssd_resnet152_v1_fpn_640x640_coco17_tpu-8.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">SSD ResNet152 V1 FPN 1024x1024 (RetinaNet152)</td>
<td style="text-align:right">111</td>
<td>39.6</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/ssd_resnet152_v1_fpn_1024x1024_coco17_tpu-8.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">Faster R-CNN ResNet50 V1 640x640</td>
<td style="text-align:right">53</td>
<td>29.3</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/faster_rcnn_resnet50_v1_640x640_coco17_tpu-8.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">Faster R-CNN ResNet50 V1 1024x1024</td>
<td style="text-align:right">65</td>
<td>31</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/faster_rcnn_resnet50_v1_1024x1024_coco17_tpu-8.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">Faster R-CNN ResNet50 V1 800x1333</td>
<td style="text-align:right">65</td>
<td>31.6</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/faster_rcnn_resnet50_v1_800x1333_coco17_gpu-8.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">Faster R-CNN ResNet101 V1 640x640</td>
<td style="text-align:right">55</td>
<td>31.8</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/faster_rcnn_resnet101_v1_640x640_coco17_tpu-8.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">Faster R-CNN ResNet101 V1 1024x1024</td>
<td style="text-align:right">72</td>
<td>37.1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/faster_rcnn_resnet101_v1_1024x1024_coco17_tpu-8.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">Faster R-CNN ResNet101 V1 800x1333</td>
<td style="text-align:right">77</td>
<td>36.6</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/faster_rcnn_resnet101_v1_800x1333_coco17_gpu-8.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">Faster R-CNN ResNet152 V1 640x640</td>
<td style="text-align:right">64</td>
<td>32.4</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/faster_rcnn_resnet152_v1_640x640_coco17_tpu-8.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">Faster R-CNN ResNet152 V1 1024x1024</td>
<td style="text-align:right">85</td>
<td>37.6</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/faster_rcnn_resnet152_v1_1024x1024_coco17_tpu-8.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">Faster R-CNN ResNet152 V1 800x1333</td>
<td style="text-align:right">101</td>
<td>37.4</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/faster_rcnn_resnet152_v1_800x1333_coco17_gpu-8.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">Faster R-CNN Inception ResNet V2 640x640</td>
<td style="text-align:right">206</td>
<td>37.7</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/faster_rcnn_inception_resnet_v2_640x640_coco17_tpu-8.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">Faster R-CNN Inception ResNet V2 1024x1024</td>
<td style="text-align:right">236</td>
<td>38.7</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/faster_rcnn_inception_resnet_v2_1024x1024_coco17_tpu-8.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">Mask R-CNN Inception ResNet V2 1024x1024</td>
<td style="text-align:right">301</td>
<td>39</td>
<td>34.6</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/mask_rcnn_inception_resnet_v2_1024x1024_coco17_gpu-8.tar.gz" target="_blank">link</a></td>
</tr>
<tr>
<td style="text-align:center">ExtremeNet</td>
<td style="text-align:right">--</td>
<td>--</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td style="text-align:left"><a href="http://download.tensorflow.org/models/object_detection/tf2/20200711/extremenet.tar.gz" target="_blank">link</a></td>
</tr>
</tbody>
</table>
<h3 id="312-&#x4E0B;&#x8F7D;&#x6A21;&#x578B;"><a name="312-&#x4E0B;&#x8F7D;&#x6A21;&#x578B;" class="plugin-anchor" href="#312-&#x4E0B;&#x8F7D;&#x6A21;&#x578B;"><i class="fa fa-link" aria-hidden="true"></i></a>3.1.2 &#x4E0B;&#x8F7D;&#x6A21;&#x578B;</h3>
<p>&#x6A21;&#x578B;&#x4E0B;&#x8F7D;python&#x7A0B;&#x5E8F;</p>
<pre><code class="lang-python"><span class="hljs-comment">#!/usr/bin/env python</span>
<span class="hljs-comment"># author:AnFany</span>
<span class="hljs-comment"># datetime:2020/12/4 11:34</span>

<span class="hljs-keyword">import</span> urllib.request
<span class="hljs-keyword">import</span> os
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-comment"># &#x4E0B;&#x8F7D;&#x6A21;&#x578B;&#x5230;&#x672C;&#x5730;</span>
<span class="hljs-keyword">import</span> tarfile

LocalFolder = <span class="hljs-string">r&apos;E:\TF_OD\model_zoo&apos;</span>

<span class="hljs-comment"># &#x83B7;&#x5F97;&#x6A21;&#x578B;&#x4E0B;&#x8F7D;&#x5730;&#x5740;</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">load_model</span><span class="hljs-params">(csv=<span class="hljs-string">r&apos;E:\TF_OD\py_pycharm\tfod_model_zoo.csv&apos;</span>, folder=LocalFolder)</span>:</span>
    data = pd.read_csv(csv, encoding=<span class="hljs-string">&apos;gbk&apos;</span>)
    <span class="hljs-keyword">for</span> add <span class="hljs-keyword">in</span> data[<span class="hljs-string">&apos;&#x5730;&#x5740;&apos;</span>].values:
        name = add.split(<span class="hljs-string">&apos;/&apos;</span>)
        <span class="hljs-keyword">if</span> name[<span class="hljs-number">-1</span>] <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> os.listdir(folder):
            print(<span class="hljs-string">&apos;&#x6A21;&#x578B;%s Loading&#x2026;&#x2026;&apos;</span> % name[<span class="hljs-number">-1</span>])
            urllib.request.urlretrieve(add, folder + <span class="hljs-string">&apos;\\%s&apos;</span> % name[<span class="hljs-number">-1</span>])
    <span class="hljs-comment"># &#x5C06;&#x6A21;&#x578B;&#x89E3;&#x538B;&#x5230;&#x6587;&#x4EF6;&#x5939;&#x4E2D;</span>
    file_list = os.listdir(folder)
    <span class="hljs-keyword">for</span> file <span class="hljs-keyword">in</span> file_list:
        <span class="hljs-keyword">if</span> <span class="hljs-string">&apos;.tar.gz&apos;</span> <span class="hljs-keyword">in</span> file:
            print(<span class="hljs-string">&apos;&#x6A21;&#x578B;%s&#x89E3;&#x538B;&#x7F29;&#x2026;&#x2026;&#x2026;&#x2026;&#x2026;&#x2026;&apos;</span> % file)
            <span class="hljs-keyword">try</span>:
                t = tarfile.open(folder + <span class="hljs-string">&apos;\\%s&apos;</span> % file)
                t.extractall(path=folder)
                t.close()
                print(<span class="hljs-string">&apos;&#x5B8C;&#x6210;&apos;</span>)
            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
                print(<span class="hljs-string">&apos;Warning&#xFF01;&#xFF01;&#x5931;&#x8D25;&#xFF0C;&#x6A21;&#x578B;%s&#x6CA1;&#x6709;&#x4E0B;&#x8F7D;&#x5B8C;&#xFF0C;&#x8BF7;&#x91CD;&#x65B0;&#x4E0B;&#x8F7D;&apos;</span> % file)

    <span class="hljs-keyword">return</span> print(<span class="hljs-string">&apos;&#x6A21;&#x578B;&#x4E0B;&#x8F7D;&#x5B8C;&#x6BD5;&apos;</span>)

load_model()
</code></pre>
<p><img src="figure/2.22.png" style="zoom:80%;"></p>
<h2 id="32-&#x56FE;&#x7247;&#x76EE;&#x6807;&#x68C0;&#x6D4B;"><a name="32-&#x56FE;&#x7247;&#x76EE;&#x6807;&#x68C0;&#x6D4B;" class="plugin-anchor" href="#32-&#x56FE;&#x7247;&#x76EE;&#x6807;&#x68C0;&#x6D4B;"><i class="fa fa-link" aria-hidden="true"></i></a>3.2 &#x56FE;&#x7247;&#x76EE;&#x6807;&#x68C0;&#x6D4B;</h2>
<p>python&#x7A0B;&#x5E8F;</p>
<pre><code class="lang-python"><span class="hljs-comment">#!/usr/bin/env python</span>
<span class="hljs-comment"># author:AnFany</span>
<span class="hljs-comment"># datetime:2020/12/4 13:18</span>

<span class="hljs-comment"># &#x5229;&#x7528;&#x4E0B;&#x8F7D;&#x5230;&#x672C;&#x5730;&#x7684;&#x6A21;&#x578B;&#x5B9E;&#x73B0;&#x56FE;&#x7247;&#x7684;&#x76EE;&#x6807;&#x68C0;&#x6D4B;</span>
<span class="hljs-keyword">import</span> os
<span class="hljs-keyword">import</span> tensorflow <span class="hljs-keyword">as</span> tf
<span class="hljs-keyword">from</span> object_detection.utils <span class="hljs-keyword">import</span> label_map_util
<span class="hljs-keyword">from</span> object_detection.utils <span class="hljs-keyword">import</span> visualization_utils <span class="hljs-keyword">as</span> viz_utils
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image


<span class="hljs-comment"># &#x6A21;&#x578B;&#x540D;&#x79F0;</span>
Model_Path = <span class="hljs-string">r&apos;E:\TF_OD\model_zoo\efficientdet_d2_coco17_tpu-32&apos;</span>
<span class="hljs-comment"># &#x8F93;&#x5165;&#x56FE;&#x7247;&#x8DEF;&#x5F84;</span>
In_Figure_Path = <span class="hljs-string">r&apos;E:\TF_OD\IN_Figure&apos;</span>
<span class="hljs-comment"># &#x8F93;&#x51FA;&#x56FE;&#x7247;&#x8DEF;&#x5F84;</span>
Out_Figure_Path = <span class="hljs-string">r&apos;E:\TF_OD\Out_Figure&apos;</span>
<span class="hljs-comment"># &#x6807;&#x7B7E;&#x6587;&#x4EF6;</span>
PATH_TO_LABELS = <span class="hljs-string">&apos;E:\TF_OD\py_pycharm\mscoco_label_map.pbtxt&apos;</span>


<span class="hljs-comment"># &#x56FE;&#x7247;&#x683C;&#x5F0F;&#x8F6C;&#x4E3A;&#x6570;&#x7EC4;</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">load_image_into_numpy_array</span><span class="hljs-params">(path)</span>:</span>
    <span class="hljs-keyword">return</span> np.array(Image.open(path))

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">figure_object_detection</span><span class="hljs-params">(modelp=Model_Path, infigurep=In_Figure_Path, labelsp=PATH_TO_LABELS, outfigure=Out_Figure_Path)</span>:</span>
    <span class="hljs-string">&quot;&quot;&quot;
    &#x5B9E;&#x73B0;&#x56FE;&#x7247;&#x7684;&#x76EE;&#x6807;&#x68C0;&#x6D4B;
    :param modelp: &#x6A21;&#x578B;&#x8DEF;&#x5F84;
    :param infigurep: &#x8F93;&#x5165;&#x56FE;&#x7247;&#x7684;&#x8DEF;&#x5F84;
    :param labelsp: &#x6807;&#x7B7E;&#x8DEF;&#x5F84;
    :param oj: &#x9700;&#x8981;&#x8BC6;&#x522B;&#x51FA;&#x7684;&#x7C7B;&#x522B;
    :return: &#x8BC6;&#x522B;&#x51FA;&#x7684;&#x56FE;&#x7247;&#x5B58;&#x653E;&#x8DEF;&#x5F84;
    &quot;&quot;&quot;</span>
    <span class="hljs-comment"># &#x83B7;&#x53D6;&#x8BC6;&#x522B;&#x7269;&#x4F53;&#x7684;&#x6807;&#x7B7E;&#x5BF9;&#x5E94;&#x5B57;&#x5178;</span>
    category_index = label_map_util.create_category_index_from_labelmap(labelsp, use_display_name=<span class="hljs-keyword">True</span>)

    <span class="hljs-comment"># &#x52A0;&#x8F7D;&#x6A21;&#x578B;</span>
    detect_fn = tf.saved_model.load(modelp + <span class="hljs-string">&quot;/saved_model&quot;</span>)

    <span class="hljs-comment"># &#x56FE;&#x7247;&#x8F6C;&#x6570;&#x7EC4;</span>
    <span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> os.listdir(infigurep):
        image_np = load_image_into_numpy_array(<span class="hljs-string">r&apos;%s/%s&apos;</span> %(infigurep, f))
        input_tensor = tf.convert_to_tensor(image_np)
        input_tensor = input_tensor[tf.newaxis, ...]
        detections = detect_fn(input_tensor)

        num_detections = int(detections.pop(<span class="hljs-string">&apos;num_detections&apos;</span>))

        detections = {key: value[<span class="hljs-number">0</span>, :num_detections].numpy() <span class="hljs-keyword">for</span> key, value <span class="hljs-keyword">in</span> detections.items()}
        detections[<span class="hljs-string">&apos;num_detections&apos;</span>] = num_detections
        detections[<span class="hljs-string">&apos;detection_classes&apos;</span>] = detections[<span class="hljs-string">&apos;detection_classes&apos;</span>].astype(np.int64)
        image_np_with_detections = image_np.copy()
        viz_utils.visualize_boxes_and_labels_on_image_array(
            image_np_with_detections,
            detections[<span class="hljs-string">&apos;detection_boxes&apos;</span>],
            detections[<span class="hljs-string">&apos;detection_classes&apos;</span>],
            detections[<span class="hljs-string">&apos;detection_scores&apos;</span>],
            category_index,
            use_normalized_coordinates=<span class="hljs-keyword">True</span>,
            max_boxes_to_draw=<span class="hljs-number">200</span>,
            min_score_thresh=<span class="hljs-number">.30</span>,
            agnostic_mode=<span class="hljs-keyword">False</span>)

        <span class="hljs-comment"># &#x4FDD;&#x5B58;&#x4E3A;&#x56FE;&#x7247;</span>
        image = Image.fromarray(image_np_with_detections, <span class="hljs-string">&apos;RGB&apos;</span>)
        image.save(<span class="hljs-string">r&apos;%s/%s&apos;</span> % (outfigure, f))

figure_object_detection()
</code></pre>
<h2 id="33-&#x89C6;&#x9891;&#x76EE;&#x6807;&#x68C0;&#x6D4B;"><a name="33-&#x89C6;&#x9891;&#x76EE;&#x6807;&#x68C0;&#x6D4B;" class="plugin-anchor" href="#33-&#x89C6;&#x9891;&#x76EE;&#x6807;&#x68C0;&#x6D4B;"><i class="fa fa-link" aria-hidden="true"></i></a>3.3 &#x89C6;&#x9891;&#x76EE;&#x6807;&#x68C0;&#x6D4B;</h2>
<h3 id="331-&#x672C;&#x5730;&#x89C6;&#x9891;"><a name="331-&#x672C;&#x5730;&#x89C6;&#x9891;" class="plugin-anchor" href="#331-&#x672C;&#x5730;&#x89C6;&#x9891;"><i class="fa fa-link" aria-hidden="true"></i></a>3.3.1 &#x672C;&#x5730;&#x89C6;&#x9891;</h3>
<p>&#x5B9E;&#x73B0;&#x601D;&#x8DEF;&#xFF1A;&#x5C06;&#x89C6;&#x9891;&#x5206;&#x6210;&#x5E27;&#x8FDB;&#x884C;&#x76EE;&#x6807;&#x68C0;&#x6D4B;&#xFF0C;&#x7136;&#x540E;&#x5728;&#x7EC4;&#x5408;&#x6210;&#x89C6;&#x9891;&#x3002;</p>
<p>python&#x7A0B;&#x5E8F;</p>
<pre><code class="lang-python"><span class="hljs-comment">#!/usr/bin/env python</span>
<span class="hljs-comment"># author:AnFany</span>
<span class="hljs-comment"># datetime:2020/12/11 16:03</span>

<span class="hljs-comment"># &#x5B9E;&#x73B0;&#x672C;&#x5730;&#x89C6;&#x9891;&#x7684;&#x76EE;&#x6807;&#x68C0;&#x6D4B;</span>
<span class="hljs-keyword">import</span> cv2
<span class="hljs-keyword">import</span> os
<span class="hljs-keyword">import</span> tensorflow <span class="hljs-keyword">as</span> tf
<span class="hljs-keyword">from</span> object_detection.utils <span class="hljs-keyword">import</span> label_map_util
<span class="hljs-keyword">from</span> object_detection.utils <span class="hljs-keyword">import</span> visualization_utils <span class="hljs-keyword">as</span> viz_utils
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image


VideoInPath = <span class="hljs-string">r&apos;E:\odapi_gwt\models\workspace\training_demo_RiverFloatage\river_video_floatage\Video_2020-11-30_161247.wmv&apos;</span>
VideoOutPath = <span class="hljs-string">r&apos;E:\odapi_gwt\models\workspace\training_demo_RiverFloatage\river_video_floatage\test_RF.mp4&apos;</span>
Figpath = <span class="hljs-string">r&apos;E:\odapi_gwt\models\workspace\training_demo_RiverFloatage\river_video_floatage\test_fig&apos;</span>
TimeInt = <span class="hljs-number">1</span> <span class="hljs-comment"># &#x95F4;&#x9694;&#x4E00;&#x5E27;&#x4FDD;&#x5B58;&#x4E00;&#x5F20;&#x56FE;&#x7247;</span>
FPs = <span class="hljs-number">40</span>

<span class="hljs-comment"># &#x6A21;&#x578B;&#x540D;&#x79F0;</span>
Model_Path = <span class="hljs-string">r&apos;E:\odapi_gwt\models\workspace\training_demo_RiverFloatage\exported-models\RiverFloatage_Model&apos;</span>
<span class="hljs-comment"># &#x6807;&#x7B7E;&#x6587;&#x4EF6;</span>
PATH_TO_LABELS = <span class="hljs-string">r&apos;E:\odapi_gwt\models\workspace\training_demo_RiverFloatage\annotations\river_floatage.pbtxt&apos;</span>


<span class="hljs-string">&quot;&quot;&quot;
# &#x7B2C;&#x4E00;&#x90E8;&#x5206;&#xFF1A;&#x89C6;&#x9891;&#x62C6;&#x6210;&#x5E27;
&quot;&quot;&quot;</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">video2figure</span><span class="hljs-params">(videos_path=VideoInPath, figure_path=Figpath, time_interval=TimeInt)</span>:</span>
    fig_list = []
    vidcap = cv2.VideoCapture(videos_path)
    success, image = vidcap.read()
    count = <span class="hljs-number">0</span>
    <span class="hljs-keyword">while</span> success:
        success, image = vidcap.read()
        <span class="hljs-keyword">if</span> count % time_interval == <span class="hljs-number">0</span>:
            <span class="hljs-keyword">if</span> image <span class="hljs-keyword">is</span> <span class="hljs-keyword">None</span>:
                <span class="hljs-keyword">break</span>
            cv2.imencode(<span class="hljs-string">&apos;.jpg&apos;</span>, image)[<span class="hljs-number">1</span>].tofile(<span class="hljs-string">&apos;%s/fig_%d.jpg&apos;</span> % (figure_path, count))
            fig_list.append(<span class="hljs-string">&apos;fig_%d.jpg&apos;</span> % count)
        count += <span class="hljs-number">1</span>
    print(<span class="hljs-string">&apos;&#x89C6;&#x9891;&#x8F6C;&#x6362;&#x4E3A;&#x56FE;&#x7247;&apos;</span>)
    <span class="hljs-keyword">return</span> fig_list

<span class="hljs-string">&quot;&quot;&quot;
# &#x7B2C;&#x4E8C;&#x90E8;&#x5206;&#xFF1A;&#x76EE;&#x6807;&#x68C0;&#x6D4B;&#x56FE;&#x7247;
&quot;&quot;&quot;</span>

<span class="hljs-comment"># &#x56FE;&#x7247;&#x683C;&#x5F0F;&#x8F6C;&#x4E3A;&#x6570;&#x7EC4;</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">load_image_into_numpy_array</span><span class="hljs-params">(path)</span>:</span>
    <span class="hljs-keyword">return</span> np.array(Image.open(path))

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">figure_object_detection</span><span class="hljs-params">(modelp=Model_Path, infigurep=video2figure<span class="hljs-params">()</span>, labelsp=PATH_TO_LABELS, outfigure=Figpath)</span>:</span>
    <span class="hljs-string">&quot;&quot;&quot;
    &#x5B9E;&#x73B0;&#x56FE;&#x7247;&#x7684;&#x76EE;&#x6807;&#x68C0;&#x6D4B;
    :param modelp: &#x6A21;&#x578B;&#x8DEF;&#x5F84;
    :param infigurep: &#x8F93;&#x5165;&#x56FE;&#x7247;&#x7684;&#x8DEF;&#x5F84;
    :param labelsp: &#x6807;&#x7B7E;&#x8DEF;&#x5F84;
    :param oj: &#x9700;&#x8981;&#x8BC6;&#x522B;&#x51FA;&#x7684;&#x7C7B;&#x522B;
    :return: &#x8BC6;&#x522B;&#x51FA;&#x7684;&#x56FE;&#x7247;&#x5B58;&#x653E;&#x8DEF;&#x5F84;
    &quot;&quot;&quot;</span>
    <span class="hljs-comment"># &#x83B7;&#x53D6;&#x8BC6;&#x522B;&#x7269;&#x4F53;&#x7684;&#x6807;&#x7B7E;&#x5BF9;&#x5E94;&#x5B57;&#x5178;</span>
    category_index = label_map_util.create_category_index_from_labelmap(labelsp, use_display_name=<span class="hljs-keyword">True</span>)

    <span class="hljs-comment"># &#x52A0;&#x8F7D;&#x6A21;&#x578B;</span>
    detect_fn = tf.saved_model.load(modelp + <span class="hljs-string">&quot;/saved_model&quot;</span>)

    <span class="hljs-comment"># &#x68C0;&#x6D4B;&#x540E;&#x7684;&#x56FE;&#x7247;&#x5217;&#x8868;</span>
    object_fig_list = []

    <span class="hljs-comment"># &#x56FE;&#x7247;&#x8F6C;&#x6570;&#x7EC4;</span>
    <span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> infigurep:
        image_np = load_image_into_numpy_array(<span class="hljs-string">r&apos;%s/%s&apos;</span> %(outfigure, f))
        input_tensor = tf.convert_to_tensor(image_np)
        input_tensor = input_tensor[tf.newaxis, ...]
        detections = detect_fn(input_tensor)
        num_detections = int(detections.pop(<span class="hljs-string">&apos;num_detections&apos;</span>))
        detections = {key: value[<span class="hljs-number">0</span>, :num_detections].numpy() <span class="hljs-keyword">for</span> key, value <span class="hljs-keyword">in</span> detections.items()}
        detections[<span class="hljs-string">&apos;num_detections&apos;</span>] = num_detections
        detections[<span class="hljs-string">&apos;detection_classes&apos;</span>] = detections[<span class="hljs-string">&apos;detection_classes&apos;</span>].astype(np.int64)
        image_np_with_detections = image_np.copy()
        viz_utils.visualize_boxes_and_labels_on_image_array(
            image_np_with_detections,
            detections[<span class="hljs-string">&apos;detection_boxes&apos;</span>],
            detections[<span class="hljs-string">&apos;detection_classes&apos;</span>],
            detections[<span class="hljs-string">&apos;detection_scores&apos;</span>],
            category_index,
            use_normalized_coordinates=<span class="hljs-keyword">True</span>,
            max_boxes_to_draw=<span class="hljs-number">3</span>,
            min_score_thresh=<span class="hljs-number">0.2</span>,
            agnostic_mode=<span class="hljs-keyword">False</span>)
        <span class="hljs-comment"># &#x4FDD;&#x5B58;&#x4E3A;&#x56FE;&#x7247;</span>
        image = Image.fromarray(image_np_with_detections, <span class="hljs-string">&apos;RGB&apos;</span>)
        image.save(<span class="hljs-string">r&apos;%s/od_%s&apos;</span> % (outfigure, f))
        object_fig_list.append(<span class="hljs-string">r&apos;%s/od_%s&apos;</span> % (outfigure, f))
    print(<span class="hljs-string">&apos;&#x68C0;&#x6D4B;&#x5B8C;&#x6BD5;&apos;</span>)
    <span class="hljs-keyword">return</span> object_fig_list

<span class="hljs-string">&quot;&quot;&quot;
# &#x7B2C;&#x4E09;&#x90E8;&#x5206;&#xFF1A;&#x56FE;&#x7247;&#x8FDE;&#x6210;&#x89C6;&#x9891;
&quot;&quot;&quot;</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">figure2video</span><span class="hljs-params">(figlist=figure_object_detection<span class="hljs-params">()</span>, outpath=VideoOutPath, fps=FPs)</span>:</span>
    img = Image.open(figlist[<span class="hljs-number">0</span>])
    img_size = img.size  <span class="hljs-comment"># &#x83B7;&#x5F97;&#x56FE;&#x7247;&#x5206;&#x8FA8;&#x7387;&#xFF0C;im_dir&#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x7684;&#x56FE;&#x7247;&#x5206;&#x8FA8;&#x7387;&#x9700;&#x8981;&#x4E00;&#x81F4;</span>

    fourcc = cv2.VideoWriter_fourcc(*<span class="hljs-string">&apos;mp4v&apos;</span>)
    videoWriter = cv2.VideoWriter(outpath, fourcc, fps, img_size)

    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> figlist:
        frame = cv2.imdecode(np.fromfile(i, dtype=np.uint8), <span class="hljs-number">-1</span>)
        videoWriter.write(frame)
    videoWriter.release()
    <span class="hljs-keyword">return</span> print(<span class="hljs-string">&apos;&#x89C6;&#x9891;&#x5B8C;&#x6BD5;&apos;</span>)


figure2video()
</code></pre>
<h3 id="332-&#x5728;&#x7EBF;&#x89C6;&#x9891;"><a name="332-&#x5728;&#x7EBF;&#x89C6;&#x9891;" class="plugin-anchor" href="#332-&#x5728;&#x7EBF;&#x89C6;&#x9891;"><i class="fa fa-link" aria-hidden="true"></i></a>3.3.2 &#x5728;&#x7EBF;&#x89C6;&#x9891;</h3>
<p>&#x5B9E;&#x73B0;&#x601D;&#x8DEF;&#xFF1A;&#x5229;&#x7528;OpenCV&#x5B9E;&#x73B0;&#x3002;python&#x7A0B;&#x5E8F;</p>
<pre><code class="lang-python"><span class="hljs-comment">#!/usr/bin/env python</span>
<span class="hljs-comment"># author:AnFany</span>
<span class="hljs-comment"># datetime:2020/12/11 16:00</span>

<span class="hljs-comment"># &#x5B9E;&#x73B0;&#x5B9E;&#x65F6;&#x89C6;&#x9891;&#x7684;&#x76EE;&#x6807;&#x68C0;&#x6D4B;</span>

<span class="hljs-keyword">import</span> cv2
<span class="hljs-keyword">import</span> os
<span class="hljs-keyword">import</span> tensorflow <span class="hljs-keyword">as</span> tf
<span class="hljs-keyword">from</span> object_detection.utils <span class="hljs-keyword">import</span> label_map_util
<span class="hljs-keyword">from</span> object_detection.utils <span class="hljs-keyword">import</span> visualization_utils <span class="hljs-keyword">as</span> viz_utils
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image


<span class="hljs-comment"># &#x6A21;&#x578B;&#x540D;&#x79F0;</span>
Model_Path = <span class="hljs-string">r&apos;E:\odapi_gwt\models\workspace\training_demo_james_kobe\exported-models\Lebron_Kobe_Model&apos;</span>
<span class="hljs-comment"># &#x6807;&#x7B7E;&#x6587;&#x4EF6;</span>
PATH_TO_LABELS = <span class="hljs-string">r&apos;E:\odapi_gwt\models\workspace\training_demo_james_kobe\annotations\label_map.pbtxt&apos;</span>

<span class="hljs-comment"># &#x5B9E;&#x65F6;&#x89C6;&#x9891;&#x7684;&#x8F93;&#x5165;&#x6587;&#x4EF6;</span>
CAPVideo = cv2.VideoCapture(<span class="hljs-number">0</span>, cv2.CAP_DSHOW)


<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">real_time_object_detection</span><span class="hljs-params">(modelp=Model_Path, labelsp=PATH_TO_LABELS, cap=CAPVideo)</span>:</span>
    <span class="hljs-comment"># &#x83B7;&#x53D6;&#x8BC6;&#x522B;&#x7269;&#x4F53;&#x7684;&#x6807;&#x7B7E;&#x5BF9;&#x5E94;&#x5B57;&#x5178;</span>
    category_index = label_map_util.create_category_index_from_labelmap(labelsp, use_display_name=<span class="hljs-keyword">True</span>)
    <span class="hljs-comment"># &#x52A0;&#x8F7D;&#x6A21;&#x578B;</span>
    detect_fn = tf.saved_model.load(modelp + <span class="hljs-string">&quot;/saved_model&quot;</span>)

    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:
        ret, image_np = cap.read()
        print(image_np)
        input_tensor = tf.convert_to_tensor(image_np)
        input_tensor = input_tensor[tf.newaxis, ...]
        detections = detect_fn(input_tensor)
        num_detections = int(detections.pop(<span class="hljs-string">&apos;num_detections&apos;</span>))
        detections = {key: value[<span class="hljs-number">0</span>, :num_detections].numpy() <span class="hljs-keyword">for</span> key, value <span class="hljs-keyword">in</span> detections.items()}
        detections[<span class="hljs-string">&apos;num_detections&apos;</span>] = num_detections
        detections[<span class="hljs-string">&apos;detection_classes&apos;</span>] = detections[<span class="hljs-string">&apos;detection_classes&apos;</span>].astype(np.int64)
        image_np_with_detections = image_np.copy()
        viz_utils.visualize_boxes_and_labels_on_image_array(
            image_np_with_detections,
            detections[<span class="hljs-string">&apos;detection_boxes&apos;</span>],
            detections[<span class="hljs-string">&apos;detection_classes&apos;</span>],
            detections[<span class="hljs-string">&apos;detection_scores&apos;</span>],
            category_index,
            use_normalized_coordinates=<span class="hljs-keyword">True</span>,
            max_boxes_to_draw=<span class="hljs-number">3</span>,
            min_score_thresh=<span class="hljs-number">0.2</span>,
            agnostic_mode=<span class="hljs-keyword">False</span>)
        <span class="hljs-comment">#</span>
        cv2.imshow(<span class="hljs-string">&apos;object detection&apos;</span>, image_np_with_detections)
        <span class="hljs-keyword">if</span> cv2.waitKey(<span class="hljs-number">25</span>) &amp; <span class="hljs-number">0xFF</span> == ord(<span class="hljs-string">&apos;q&apos;</span>):
            cv2.destroyAllWindows()
            <span class="hljs-keyword">break</span>
    cap.release()
    cv2.destroyAllWindows()


real_time_object_detection()
</code></pre>
<footer class="page-footer"><span class="copyright">Copyright &#xA9; AnFany 2020 all right reserved&#xFF0C;powered by Gitbook</span><span class="footer-modification">&#x6700;&#x8FD1;&#x4FEE;&#x8BA2;&#x65F6;&#x95F4;&#xFF1A;
2021-01-04 11:54:56
</span></footer>
<script>console.log("plugin-popup....");document.onclick = function(e){ e.target.tagName === "IMG" && window.open(e.target.src,e.target.src)}</script><style>img{cursor:pointer}</style>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="chapter2.html#24-安装object-detection-api" class="navigation navigation-prev " aria-label="Previous page: 2.4 安装Object Detection API">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="chapter3.html#31-模型下载" class="navigation navigation-next " aria-label="Next page: 3.1 模型下载">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"3 目标检测模型","level":"1.4","depth":1,"next":{"title":"3.1 模型下载","level":"1.4.1","depth":2,"anchor":"#31-模型下载","path":"chapter3.md","ref":"chapter3.md#31-模型下载","articles":[{"title":"3.1.1 获取模型信息","level":"1.4.1.1","depth":3,"anchor":"#311-获取模型信息","path":"chapter3.md","ref":"chapter3.md#311-获取模型信息","articles":[]},{"title":"3.1.2 下载模型","level":"1.4.1.2","depth":3,"anchor":"#312-下载模型","path":"chapter3.md","ref":"chapter3.md#312-下载模型","articles":[]}]},"previous":{"title":"2.4 安装Object Detection API","level":"1.3.4","depth":2,"anchor":"#24-安装object-detection-api","path":"chapter2.md","ref":"chapter2.md#24-安装object-detection-api","articles":[]},"dir":"ltr"},"config":{"plugins":["anchors","tbfed-pagefooter","donate","chapter-fold","splitter","back-to-top-button","github@2.0.0","hide-element","code","-sharing","sharing-plus","auto-scroll-table","pageview-count","popup","livereload"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"tbfed-pagefooter":{"copyright":"Copyright &copy AnFany 2020","modify_label":"最近修订时间：","modify_format":"YYYY-MM-DD HH:mm:ss"},"chapter-fold":{},"github":{"url":"https://github.com/Anfany"},"livereload":{},"splitter":{},"search":{},"sharing-plus":{"qq":false,"all":["facebook","google","twitter","instapaper","linkedin","pocket","stumbleupon"],"douban":false,"facebook":true,"weibo":false,"instapaper":false,"whatsapp":false,"hatenaBookmark":false,"twitter":true,"messenger":false,"line":false,"vk":false,"pocket":true,"google":false,"viber":false,"stumbleupon":false,"qzone":false,"linkedin":false},"auto-scroll-table":{},"popup":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"code":{"copyButtons":true},"donate":{"alipay":"figure/0.0.jpg","alipayText":"支付宝赞助","button":"神来之笔","title":"","wechat":"figure/0.1.jpg","wechatText":"微信赞助"},"hide-element":{"elements":[".gitbook-link"]},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"back-to-top-button":{},"pageview-count":{},"sharing":{"qq":false,"all":["douban","facebook","google","linkedin","twitter","qq","weibo","whatsapp"],"douban":false,"facebook":false,"weibo":false,"whatsapp":false,"twitter":false,"google":false,"linkedin":false},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"anchors":{}},"theme":"default","author":"AnFany","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Machine Vision CookBook with TensorFlow2","language":"zh-hans","gitbook":"*"},"file":{"path":"chapter3.md","mtime":"2021-01-04T03:54:56.000Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-01-05T01:52:19.858Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-donate/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-chapter-fold/chapter-fold.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-back-to-top-button/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-hide-element/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-code/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing-plus/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-auto-scroll-table/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-pageview-count/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

